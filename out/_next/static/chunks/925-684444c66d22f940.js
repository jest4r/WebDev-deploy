"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[925],{79205:function(e,r,t){t.d(r,{Z:function(){return l}});var n=t(2265);let s=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),a=function(){for(var e=arguments.length,r=Array(e),t=0;t<e;t++)r[t]=arguments[t];return r.filter((e,r,t)=>!!e&&t.indexOf(e)===r).join(" ")};var o={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let i=(0,n.forwardRef)((e,r)=>{let{color:t="currentColor",size:s=24,strokeWidth:i=2,absoluteStrokeWidth:l,className:c="",children:u,iconNode:h,...d}=e;return(0,n.createElement)("svg",{ref:r,...o,width:s,height:s,stroke:t,strokeWidth:l?24*Number(i)/Number(s):i,className:a("lucide",c),...d},[...h.map(e=>{let[r,t]=e;return(0,n.createElement)(r,t)}),...Array.isArray(u)?u:[u]])}),l=(e,r)=>{let t=(0,n.forwardRef)((t,o)=>{let{className:l,...c}=t;return(0,n.createElement)(i,{ref:o,iconNode:r,className:a("lucide-".concat(s(e)),l),...c})});return t.displayName="".concat(e),t}},87769:function(e,r,t){t.d(r,{Z:function(){return n}});let n=(0,t(79205).Z)("EyeOff",[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]])},42208:function(e,r,t){t.d(r,{Z:function(){return n}});let n=(0,t(79205).Z)("Eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]])},13595:function(e,r,t){var n=t(57437);t(2265),r.Z=e=>{let{imageUrl:r="/img/back.png"}=e;return(0,n.jsx)("div",{className:"flex inset-2 z-0 w-full min-h-screen",style:{backgroundImage:"url(".concat(r,")"),backgroundSize:"cover",backgroundPosition:"center",backgroundRepeat:"no-repeat",opacity:.5}})}},11002:function(e,r,t){t.d(r,{Dj:function(){return s},UR:function(){return i},YA:function(){return l},kS:function(){return a},uJ:function(){return o}});let n=(0,t(1455).oM)({name:"auth",initialState:{user:null,accessToken:null,refreshToken:null,isAuthenticated:!1,isTasker:!1},reducers:{setCredentials:(e,r)=>{let{user:t,token:n}=r.payload;e.user=t,e.accessToken=n.access_token,e.refreshToken=n.refresh_token,e.isAuthenticated=!0,t.tasker&&(e.isTasker=!0),localStorage.setItem("user",JSON.stringify(t)),localStorage.setItem("isTasker",e.isTasker.toString()),localStorage.setItem("accessToken",n.access_token),localStorage.setItem("refreshToken",n.refresh_token)},setisTaskers:(e,r)=>{e.isTasker=r.payload,localStorage.setItem("isTasker","true")},logout:e=>{e.user=null,e.accessToken=null,e.refreshToken=null,e.isTasker=!1,e.isAuthenticated=!1,localStorage.removeItem("user"),localStorage.removeItem("accessToken"),localStorage.removeItem("refreshToken"),localStorage.removeItem("isTasker")},loginFailure:e=>{console.log("Login failed"),e.isAuthenticated=!1},initializeAuth:e=>{try{let r=localStorage.getItem("user"),t=localStorage.getItem("accessToken"),n=localStorage.getItem("refreshToken"),s=localStorage.getItem("isTasker");r&&t&&n?(e.user=JSON.parse(r),e.accessToken=t,e.refreshToken=n,e.isAuthenticated=!0):e.isAuthenticated=!1,(null==s?void 0:s.toString())==="true"&&(e.isTasker="true"===s)}catch(r){console.error("Error initializing auth from localStorage:",r),e.isAuthenticated=!1}}}}),{setCredentials:s,logout:a,initializeAuth:o,loginFailure:i,setisTaskers:l}=n.actions;r.ZP=n.reducer},50835:function(e,r,t){t.d(r,{CG:function(){return l},TL:function(){return i},h:function(){return o}});var n=t(1455),s=t(68575),a=t(11002);let o=(0,n.xC)({reducer:{auth:a.ZP},middleware:e=>e({serializableCheck:!1})}),i=s.I0,l=s.v9},82479:function(e,r,t){t.d(r,{O:function(){return c}});var n=t(11002),s=t(50835),a=t(83464),o=t(42321),i=t(46175);class l{async register(e){try{let r=await o.Z.post("/auth/register",JSON.stringify(e));return i.ZP.success("Đăng k\xfd th\xe0nh c\xf4ng"),r.data}catch(e){throw i.ZP.error("Đăng k\xfd thất bại"),console.log(e),e}}async login(e){try{console.log("http://localhost:5000/api/auth/login");let r=await o.Z.post("/auth/login",JSON.stringify(e)),t=r.data;return s.h.dispatch((0,n.Dj)(t)),i.ZP.success("Đăng nhập th\xe0nh c\xf4ng"),r.data}catch(r){throw console.log(r),i.ZP.error("Đăng nhập thất bại"),this.handleAuthError(e),r}}async refreshToken(){if(this.refreshPromise)return this.refreshPromise;let e=this.getRefreshToken();if(!e)throw Error("No refresh token available");return this.refreshPromise=o.Z.post("/auth/refresh",{refreshToken:e}).then(e=>{let{access_token:r,refresh_token:t}=e.data;return s.h.dispatch((0,n.Dj)({user:s.h.getState().auth.user,token:{access_token:r,refresh_token:t}})),e.data}).catch(e=>{throw this.logout(),e}).finally(()=>{this.refreshPromise=null}),this.refreshPromise}async logout(){s.h.dispatch((0,n.kS)())}handleAuthError(e){if(a.Z.isAxiosError(e)){var r,t;let a=(null===(t=e.response)||void 0===t?void 0:null===(r=t.data)||void 0===r?void 0:r.message)||"Authentication failed";s.h.dispatch((0,n.UR)(a))}else s.h.dispatch((0,n.UR)())}getAccessToken(){return s.h.getState().auth.accessToken}getRefreshToken(){return s.h.getState().auth.refreshToken}isTokenExpired(e){if(!e)return!0;try{let r=e.split(".");if(3!==r.length)return!0;let t=JSON.parse(atob(r[1]));return Date.now()>=1e3*t.exp-3e4}catch(e){return!0}}constructor(){this.refreshPromise=null}}let c=new l},42321:function(e,r,t){var n=t(83464),s=t(82479);let a=n.Z.create({baseURL:"http://localhost:5000/api",headers:{"Content-Type":"application/json",Accept:"application/json"},timeout:1e4});a.interceptors.request.use(async e=>{var r,t,n;let a=s.O.getAccessToken();if((null===(r=e.url)||void 0===r?void 0:r.includes("/auth/login"))||(null===(t=e.url)||void 0===t?void 0:t.includes("/auth/refresh"))||(null===(n=e.url)||void 0===n?void 0:n.includes("/auth/register")))return console.log(e),e;try{if(!a)throw Error("No access token available");if(s.O.isTokenExpired(a)){let r=await s.O.refreshToken();e.headers.Authorization="Bearer ".concat(r.access_token)}else e.headers.Authorization="Bearer ".concat(a)}catch(e){s.O.logout(),console.log(e)}return e},e=>Promise.reject(e)),a.interceptors.response.use(e=>e,async e=>{var r;let t=e.config;if(!t||t._retry)return Promise.reject(e);if((null===(r=e.response)||void 0===r?void 0:r.status)===401&&t.url&&!t.url.includes("/auth/login")&&!t.url.includes("/auth/refresh"))try{t._retry=!0;let e=await s.O.refreshToken();return t.headers&&(t.headers.Authorization="Bearer ".concat(e.access_token)),a(t)}catch(e){return s.O.logout(),Promise.reject(e)}return Promise.reject(e)}),r.Z=a},49365:function(e,r,t){t.d(r,{u:function(){return c}});var n=t(53921),s=t(72243),a=t(88160),o=t(46763),i=t(57437),l=(0,s.Gp)((e,r)=>{var t;let{as:s,className:l,children:c,...u}=e,h=(0,a.gy)(r),{slots:d,classNames:f}=(0,n.R)(),g=(0,o.W)(null==f?void 0:f.header,l);return(0,i.jsx)(s||"div",{ref:h,className:null==(t=d.header)?void 0:t.call(d,{class:g}),...u,children:c})});l.displayName="NextUI.CardHeader";var c=l},65349:function(e,r,t){t.d(r,{i:function(){return c}});var n=t(53921),s=t(72243),a=t(88160),o=t(46763),i=t(57437),l=(0,s.Gp)((e,r)=>{var t;let{as:s,className:l,children:c,...u}=e,h=(0,a.gy)(r),{slots:d,classNames:f}=(0,n.R)(),g=(0,o.W)(null==f?void 0:f.footer,l);return(0,i.jsx)(s||"div",{ref:h,className:null==(t=d.footer)?void 0:t.call(d,{class:g}),...u,children:c})});l.displayName="NextUI.CardFooter";var c=l},42228:function(e,r,t){t.d(r,{Y:function(){return c}});var n=t(79897),s=t(93253),a=t(2265),o=t(72243),i=t(57437),l=(0,o.Gp)((e,r)=>{let{Component:t,label:o,description:l,isClearable:c,startContent:u,endContent:h,labelPlacement:d,hasHelper:f,isOutsideLeft:g,shouldLabelBeOutside:k,errorMessage:p,isInvalid:m,getBaseProps:v,getLabelProps:y,getInputProps:T,getInnerWrapperProps:x,getInputWrapperProps:j,getMainWrapperProps:w,getHelperWrapperProps:S,getDescriptionProps:A,getErrorMessageProps:N,getClearButtonProps:b}=(0,n.G)({...e,ref:r}),I=o?(0,i.jsx)("label",{...y(),children:o}):null,Z=(0,a.useMemo)(()=>c?(0,i.jsx)("span",{...b(),children:h||(0,i.jsx)(s.f,{})}):h,[c,b]),P=(0,a.useMemo)(()=>f?(0,i.jsx)("div",{...S(),children:m&&p?(0,i.jsx)("div",{...N(),children:p}):l?(0,i.jsx)("div",{...A(),children:l}):null}):null,[f,m,p,l,S,N,A]),E=(0,a.useMemo)(()=>(0,i.jsxs)("div",{...x(),children:[u,(0,i.jsx)("input",{...T()}),Z]}),[u,Z,T,x]),O=(0,a.useMemo)(()=>k?(0,i.jsxs)("div",{...w(),children:[(0,i.jsxs)("div",{...j(),children:[g?null:I,E]}),P]}):(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("div",{...j(),children:[I,E]}),P]}),[d,P,k,I,E,p,l,w,j,N,A]);return(0,i.jsxs)(t,{...v(),children:[g?I:null,O]})});l.displayName="NextUI.Input";var c=l},93253:function(e,r,t){t.d(r,{f:function(){return s}});var n=t(57437),s=e=>(0,n.jsx)("svg",{"aria-hidden":"true",focusable:"false",height:"1em",role:"presentation",viewBox:"0 0 24 24",width:"1em",...e,children:(0,n.jsx)("path",{d:"M12 2a10 10 0 1010 10A10.016 10.016 0 0012 2zm3.36 12.3a.754.754 0 010 1.06.748.748 0 01-1.06 0l-2.3-2.3-2.3 2.3a.748.748 0 01-1.06 0 .754.754 0 010-1.06l2.3-2.3-2.3-2.3A.75.75 0 019.7 8.64l2.3 2.3 2.3-2.3a.75.75 0 011.06 1.06l-2.3 2.3z",fill:"currentColor"})})}}]);