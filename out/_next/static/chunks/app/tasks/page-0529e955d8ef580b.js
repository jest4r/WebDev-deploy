(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7289],{29068:function(e,t,r){Promise.resolve().then(r.bind(r,98020))},98020:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return S}});var s=r(57437),a=r(4922),n=r(49365),l=r(99008),c=r(67703),i=r(99394),o=r(65349),u=r(75265),d=r(33374),h=r(97717),m=r(29721),f=r(35069),x=r(88139),g=r(33145),p=r(49089),v=r(45168),y=r(63253),j=r(21949),k=r(46175);function b(e){var t;let{task:r}=e,b=e=>new Date(e).toISOString().split("T")[0],{isOpen:N,onOpen:w,onOpenChange:P}=(0,u.q)(),O=async()=>{try{await j.O.applyTask(r.id),k.ZP.success("Ứng tuyển th\xe0nh c\xf4ng!")}catch(e){k.ZP.error("Ứng tuyển thất bại!"),console.error("Lỗi khi ứng tuyển:",e)}};return(0,s.jsxs)("div",{children:[(0,s.jsxs)(a.w,{isFooterBlurred:!0,className:"w-[400px] h-[400px]",children:[(0,s.jsx)(g.default,{src:"/img/taskmanage/task-manage-bg".concat(1,".jpg"),alt:"",className:"object-cover",fill:!0}),(0,s.jsxs)(n.u,{className:"flex flex-col bg-slate-200",children:[(0,s.jsx)("p",{className:"font-bold text-emerald-700 text-xl",children:(t=r.id)<10?"A00".concat(t):t>=10&&t<100?"A0".concat(t):t<10?"A".concat(t):void 0}),(0,s.jsx)("p",{className:"font-semibold text-lg",children:r.title}),(0,s.jsxs)("p",{className:"truncate mt-2 flex items-center max-w-[290px] bg-emerald-400 rounded-xl p-2 font-bold",children:[(0,s.jsx)("span",{className:"text-emerald-900 font-semibold mr-1 ",children:"Status:"}),r.task_status]})]}),(0,s.jsx)(l.G,{className:"p-0",children:(0,s.jsx)("div",{className:"relative w-full h-full",children:(0,s.jsxs)("div",{className:"top-2/3 left-1/2 absolute flex justify-between items-center bg-gray-200 py-4 pl-2 rounded-lg w-11/12 transform -translate-x-1/2 -translate-y-1/2",children:[(0,s.jsxs)("div",{children:[(0,s.jsxs)("p",{className:"truncate mb-2  flex items-center max-w-[290px] ",children:[(0,s.jsx)(v.WzH,{className:"text-emerald-700 mr-1 text-xl"})," ",(0,s.jsx)("span",{className:"text-emerald-700 font-semibold mr-1",children:"Duration:"}),r.estimated_duration," hours"]}),(0,s.jsxs)("p",{className:"truncate mb-2  flex items-center max-w-[290px]",children:[(0,s.jsx)(v.WzH,{className:"text-emerald-700 mr-1 text-xl"})," ",(0,s.jsx)("span",{className:"text-emerald-700 font-semibold mr-1",children:"Fee per hour:"}),r.fee_per_hour," VND/h"]}),(0,s.jsxs)("p",{className:"truncate  flex items-center max-w-[290px]",children:[(0,s.jsx)(v.WzH,{className:"text-emerald-700 mr-1 text-xl"})," ",(0,s.jsx)("span",{className:"text-emerald-700 font-semibold mr-1",children:"End date:"}),r.end_date.replaceAll("T00:00:00.000Z","")]})]}),(0,s.jsx)("div",{children:(0,s.jsx)(c.e,{content:"View more details",children:(0,s.jsx)(i.A,{onPress:w,variant:"light",className:"text-emerald-700 text-lg",children:(0,s.jsx)(p.AeW,{})})})})]})})}),(0,s.jsx)(o.i,{className:"flex flex-col mt-3 h-[100px]",children:(0,s.jsx)("div",{children:(0,s.jsx)(i.A,{onPress:O,color:"success",className:"shadow-md mt-2 px-3 py-2 rounded-lg font-semibold text-white",children:"APPLY"})})})]}),(0,s.jsx)(d.R,{isOpen:N,onOpenChange:P,children:(0,s.jsx)(h.A,{children:e=>(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(m.k,{className:"font-bold text-emerald-800",children:(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsxs)("p",{className:"font-bold text-emerald-700 text-xl",children:["T00",r.id]}),(0,s.jsx)("p",{className:"font-semibold text-lg",children:r.title})]})}),(0,s.jsx)(f.I,{children:(0,s.jsxs)("div",{className:"flex flex-col gap-y-3",children:[(0,s.jsxs)("p",{className:"flex items-center",children:[(0,s.jsx)(y.qHY,{className:"text-emerald-500"}),(0,s.jsx)("span",{className:"mr-1 font-semibold text-emerald-700",children:"Description:"}),r.description]}),(0,s.jsxs)("p",{className:"flex items-center",children:[(0,s.jsx)(y.qHY,{className:"text-emerald-500"}),(0,s.jsx)("span",{className:"mr-1 font-semibold text-emerald-700",children:"Estimated Duration:"}),r.estimated_duration]}),(0,s.jsxs)("p",{className:"flex items-center",children:[(0,s.jsx)(y.qHY,{className:"text-emerald-500"}),(0,s.jsx)("span",{className:"mr-1 font-semibold text-emerald-700",children:"Fee per hour:"}),r.fee_per_hour,"VND /h"]}),(0,s.jsxs)("p",{className:"flex items-center",children:[(0,s.jsx)(y.qHY,{className:"text-emerald-500"}),(0,s.jsx)("span",{className:"mr-1 font-semibold text-emerald-700",children:"Start Date:"}),b(r.start_date)]}),(0,s.jsxs)("p",{className:"flex items-center",children:[(0,s.jsx)(y.qHY,{className:"text-emerald-500"}),(0,s.jsx)("span",{className:"mr-1 font-semibold text-emerald-700",children:"End Date:"}),b(r.end_date)]}),(0,s.jsxs)("p",{className:"flex items-center",children:[(0,s.jsx)(y.qHY,{className:"text-emerald-500"}),(0,s.jsx)("span",{className:"mr-1 font-semibold text-emerald-700",children:"Status:"}),r.task_status]})]})}),(0,s.jsx)(x.R,{children:(0,s.jsx)(i.A,{color:"danger",variant:"light",onPress:e,children:"Close"})})]})})})]})}var N=r(2265),w=r(47043);function P(){let[e,t]=(0,N.useState)([]),[r,a]=(0,N.useState)(!0),[n]=(0,N.useState)(null),[l,c]=(0,N.useState)(1),[i]=(0,N.useState)("all"),[o,u]=(0,N.useState)(null);if((0,N.useEffect)(()=>{(async()=>{t(await j.O.getMe()),a(!1)})()},[]),r)return(0,s.jsx)("div",{children:(0,s.jsx)(w.Z,{})});if(n)return(0,s.jsxs)("div",{children:["Error: ",n]});let d=Array.from(new Map(e.filter(e=>e.skill).map(e=>[e.skill.id,e.skill])).values()),h=e.filter(e=>{let t="all"===i||e.task_status===i,r=null===o||e.skill&&e.skill.id===o;return t&&r}),m=12*l,f=h.slice(m-12,m),x=Math.ceil(h.length/12),g=Array.from({length:x},(e,t)=>t+1);return(0,s.jsxs)("div",{className:"flex flex-col items-center w-full",children:[(0,s.jsx)("div",{className:"font-bold text-emerald-700 text-2xl my-10",children:"SEE ALL AVAILABLE TASKS AND CHOOSE YOUR SUITABLE ONES"}),(0,s.jsxs)("div",{className:"my-4",children:[(0,s.jsx)("label",{htmlFor:"skillFilter",className:"mr-2 font-bold text-emerald-700 text-xl",children:"Filter by Skill:"}),(0,s.jsxs)("select",{id:"skillFilter",value:o||"",onChange:e=>u(e.target.value?Number(e.target.value):null),className:"border px-3 py-2 rounded-lg",children:[(0,s.jsx)("option",{value:"",children:"All Skills"}),d.map(e=>(0,s.jsx)("option",{value:e.id,children:e.name},e.id))]})]}),(0,s.jsx)("div",{className:"flex flex-wrap items-center justify-center gap-x-10 gap-y-10",children:f.map(e=>(0,s.jsx)(b,{task:e},e.id))}),x>1&&(0,s.jsxs)("div",{className:"flex items-center gap-2 my-4",children:[(0,s.jsx)("button",{onClick:()=>c(e=>Math.max(e-1,1)),disabled:1===l,className:"bg-white disabled:opacity-50 shadow-md hover:shadow-lg px-4 py-2 rounded-lg transition-shadow disabled:cursor-not-allowed",children:"Previous"}),(0,s.jsx)("div",{className:"flex gap-2",children:g.map(e=>(0,s.jsx)("button",{onClick:()=>c(e),className:"w-10 h-10 rounded-lg flex items-center justify-center transition-all ".concat(l===e?"bg-blue-500 text-white shadow-md":"bg-white hover:bg-gray-100 shadow-md hover:shadow-lg"),children:e},e))}),(0,s.jsx)("button",{onClick:()=>c(e=>Math.min(e+1,x)),disabled:l===x,className:"bg-white disabled:opacity-50 shadow-md hover:shadow-lg px-4 py-2 rounded-lg transition-shadow disabled:cursor-not-allowed",children:"Next"})]}),0===h.length&&(0,s.jsx)("div",{className:"my-8 text-gray-500",children:"No tasks found for the selected criteria."})]})}var O=r(61915);function S(){return(0,s.jsx)(O.ProtectedRoute,{children:(0,s.jsx)("div",{className:"flex flex-col p-4 w-full",children:(0,s.jsx)("div",{className:"desktop:w-5/6 laptop:w-5/6 mx-auto w-full",children:(0,s.jsx)(P,{})})})})}},47043:function(e,t,r){"use strict";r.d(t,{Z:function(){return n}});var s=r(57437),a=r(1377);function n(){return(0,s.jsx)("div",{className:"fixed inset-0 bg-white flex items-center justify-center z-50",children:(0,s.jsx)(a.c,{size:"lg",color:"success",label:"Loading..."})})}},61915:function(e,t,r){"use strict";r.d(t,{ProtectedRoute:function(){return i}});var s=r(57437),a=r(50835),n=r(99376),l=r(2265),c=r(47043);function i(e){let{children:t}=e,{isAuthenticated:r,user:i}=(0,a.CG)(e=>e.auth),o=(0,n.useRouter)(),u=(0,n.usePathname)(),d=["/admin","/admin/users","/admin/tasks","/admin/monitor"],{isTasker:h}=(0,a.CG)(e=>e.auth);return((0,l.useEffect)(()=>{if(r){let e=window.location.pathname;!h&&["/tasks","/taskmanage"].includes(e)&&o.replace("/becometasker")}else o.replace("/login");if(d.some(e=>u.startsWith(e))&&(null==i?void 0:i.role)!=="ADMIN"){o.replace("/");return}if((null==i?void 0:i.role)==="ADMIN"&&"/"===u){o.replace("/admin");return}},[r,i,u,o]),!r||d.some(e=>u.startsWith(e))&&(null==i?void 0:i.role)!=="ADMIN")?(0,s.jsx)(c.Z,{}):t}},11002:function(e,t,r){"use strict";r.d(t,{Dj:function(){return a},UR:function(){return c},YA:function(){return i},kS:function(){return n},uJ:function(){return l}});let s=(0,r(1455).oM)({name:"auth",initialState:{user:null,accessToken:null,refreshToken:null,isAuthenticated:!1,isTasker:!1},reducers:{setCredentials:(e,t)=>{let{user:r,token:s}=t.payload;e.user=r,e.accessToken=s.access_token,e.refreshToken=s.refresh_token,e.isAuthenticated=!0,r.tasker&&(e.isTasker=!0),localStorage.setItem("user",JSON.stringify(r)),localStorage.setItem("isTasker",e.isTasker.toString()),localStorage.setItem("accessToken",s.access_token),localStorage.setItem("refreshToken",s.refresh_token)},setisTaskers:(e,t)=>{e.isTasker=t.payload,localStorage.setItem("isTasker","true")},logout:e=>{e.user=null,e.accessToken=null,e.refreshToken=null,e.isTasker=!1,e.isAuthenticated=!1,localStorage.removeItem("user"),localStorage.removeItem("accessToken"),localStorage.removeItem("refreshToken"),localStorage.removeItem("isTasker")},loginFailure:e=>{console.log("Login failed"),e.isAuthenticated=!1},initializeAuth:e=>{try{let t=localStorage.getItem("user"),r=localStorage.getItem("accessToken"),s=localStorage.getItem("refreshToken"),a=localStorage.getItem("isTasker");t&&r&&s?(e.user=JSON.parse(t),e.accessToken=r,e.refreshToken=s,e.isAuthenticated=!0):e.isAuthenticated=!1,(null==a?void 0:a.toString())==="true"&&(e.isTasker="true"===a)}catch(t){console.error("Error initializing auth from localStorage:",t),e.isAuthenticated=!1}}}}),{setCredentials:a,logout:n,initializeAuth:l,loginFailure:c,setisTaskers:i}=s.actions;t.ZP=s.reducer},50835:function(e,t,r){"use strict";r.d(t,{CG:function(){return i},TL:function(){return c},h:function(){return l}});var s=r(1455),a=r(68575),n=r(11002);let l=(0,s.xC)({reducer:{auth:n.ZP},middleware:e=>e({serializableCheck:!1})}),c=a.I0,i=a.v9},82479:function(e,t,r){"use strict";r.d(t,{O:function(){return o}});var s=r(11002),a=r(50835),n=r(83464),l=r(42321),c=r(46175);class i{async register(e){try{let t=await l.Z.post("/auth/register",JSON.stringify(e));return c.ZP.success("Đăng k\xfd th\xe0nh c\xf4ng"),t.data}catch(e){throw c.ZP.error("Đăng k\xfd thất bại"),console.log(e),e}}async login(e){try{console.log("http://localhost:5000/api/auth/login");let t=await l.Z.post("/auth/login",JSON.stringify(e)),r=t.data;return a.h.dispatch((0,s.Dj)(r)),c.ZP.success("Đăng nhập th\xe0nh c\xf4ng"),t.data}catch(t){throw console.log(t),c.ZP.error("Đăng nhập thất bại"),this.handleAuthError(e),t}}async refreshToken(){if(this.refreshPromise)return this.refreshPromise;let e=this.getRefreshToken();if(!e)throw Error("No refresh token available");return this.refreshPromise=l.Z.post("/auth/refresh",{refreshToken:e}).then(e=>{let{access_token:t,refresh_token:r}=e.data;return a.h.dispatch((0,s.Dj)({user:a.h.getState().auth.user,token:{access_token:t,refresh_token:r}})),e.data}).catch(e=>{throw this.logout(),e}).finally(()=>{this.refreshPromise=null}),this.refreshPromise}async logout(){a.h.dispatch((0,s.kS)())}handleAuthError(e){if(n.Z.isAxiosError(e)){var t,r;let n=(null===(r=e.response)||void 0===r?void 0:null===(t=r.data)||void 0===t?void 0:t.message)||"Authentication failed";a.h.dispatch((0,s.UR)(n))}else a.h.dispatch((0,s.UR)())}getAccessToken(){return a.h.getState().auth.accessToken}getRefreshToken(){return a.h.getState().auth.refreshToken}isTokenExpired(e){if(!e)return!0;try{let t=e.split(".");if(3!==t.length)return!0;let r=JSON.parse(atob(t[1]));return Date.now()>=1e3*r.exp-3e4}catch(e){return!0}}constructor(){this.refreshPromise=null}}let o=new i},42321:function(e,t,r){"use strict";var s=r(83464),a=r(82479);let n=s.Z.create({baseURL:"http://localhost:5000/api",headers:{"Content-Type":"application/json",Accept:"application/json"},timeout:1e4});n.interceptors.request.use(async e=>{var t,r,s;let n=a.O.getAccessToken();if((null===(t=e.url)||void 0===t?void 0:t.includes("/auth/login"))||(null===(r=e.url)||void 0===r?void 0:r.includes("/auth/refresh"))||(null===(s=e.url)||void 0===s?void 0:s.includes("/auth/register")))return console.log(e),e;try{if(!n)throw Error("No access token available");if(a.O.isTokenExpired(n)){let t=await a.O.refreshToken();e.headers.Authorization="Bearer ".concat(t.access_token)}else e.headers.Authorization="Bearer ".concat(n)}catch(e){a.O.logout(),console.log(e)}return e},e=>Promise.reject(e)),n.interceptors.response.use(e=>e,async e=>{var t;let r=e.config;if(!r||r._retry)return Promise.reject(e);if((null===(t=e.response)||void 0===t?void 0:t.status)===401&&r.url&&!r.url.includes("/auth/login")&&!r.url.includes("/auth/refresh"))try{r._retry=!0;let e=await a.O.refreshToken();return r.headers&&(r.headers.Authorization="Bearer ".concat(e.access_token)),n(r)}catch(e){return a.O.logout(),Promise.reject(e)}return Promise.reject(e)}),t.Z=n},21949:function(e,t,r){"use strict";r.d(t,{O:function(){return n}});var s=r(46175),a=r(42321);let n={async create(e){try{let t=await a.Z.post("/tasks",e);return s.ZP.success("Tạo c\xf4ng việc th\xe0nh c\xf4ng"),t.data}catch(e){throw s.ZP.error("Kh\xf4ng thể tạo c\xf4ng việc n\xe0y"),e}},async getMe(){try{return(await a.Z.get("/tasks/admin")).data}catch(e){throw s.ZP.error("Kh\xf4ng thể lấy th\xf4ng tin c\xf4ng việc"),e}},async deleteMe(e){try{let t=await a.Z.delete("/tasks/".concat(e.id));return s.ZP.success("Hủy c\xf4ng việc th\xe0nh c\xf4ng"),t.data}catch(e){throw s.ZP.error("Kh\xf4ng thể hủy c\xf4ng việc n\xe0y"),e}},async getAllTasksCreatedByUser(){try{return(await a.Z.get("/tasks/user")).data}catch(e){throw s.ZP.error("Kh\xf4ng thể lấy th\xf4ng tin c\xf4ng việc"),e}},async userChooseTasker(e,t){try{await a.Z.patch("/tasks/".concat(e,"/choose/").concat(t)),s.ZP.success("Chọn Người l\xe0m việc th\xe0nh c\xf4ng")}catch(e){throw s.ZP.error("Kh\xf4ng thể chọn người l\xe0m n\xe0y! H\xe3y thử lại sau"),e}},async applyTask(e){try{let t=await a.Z.patch("/tasks/".concat(e,"/apply"));return s.ZP.success("Ứng tuyển c\xf4ng việc th\xe0nh c\xf4ng!"),console.log(t.data),t.data}catch(e){throw s.ZP.error("Kh\xf4ng thể ứng tuyển c\xf4ng việc n\xe0y"),e}},async acceptTask(e){try{let t=await a.Z.patch("/tasks/".concat(e,"/accept"));return s.ZP.success("Ứng tuyển c\xf4ng việc th\xe0nh c\xf4ng!"),console.log(t.data),t.data}catch(e){throw s.ZP.error("Kh\xf4ng thể ứng tuyển c\xf4ng việc n\xe0y"),e}},async getTaskerTasks(){try{let e=await a.Z.get("/tasks/tasker");return console.log(e.data),e.data}catch(e){throw s.ZP.error("Kh\xf4ng thể lấy th\xf4ng tin c\xf4ng việc"),e}}}},65349:function(e,t,r){"use strict";r.d(t,{i:function(){return o}});var s=r(53921),a=r(72243),n=r(88160),l=r(46763),c=r(57437),i=(0,a.Gp)((e,t)=>{var r;let{as:a,className:i,children:o,...u}=e,d=(0,n.gy)(t),{slots:h,classNames:m}=(0,s.R)(),f=(0,l.W)(null==m?void 0:m.footer,i);return(0,c.jsx)(a||"div",{ref:d,className:null==(r=h.footer)?void 0:r.call(h,{class:f}),...u,children:o})});i.displayName="NextUI.CardFooter";var o=i},46231:function(e,t,r){"use strict";r.d(t,{w_:function(){return u}});var s=r(2265),a={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},n=s.createContext&&s.createContext(a),l=["attr","size","title"];function c(){return(c=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e}).apply(this,arguments)}function i(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,s)}return r}function o(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?i(Object(r),!0).forEach(function(t){var s,a;s=t,a=r[t],(s=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var s=r.call(e,t||"default");if("object"!=typeof s)return s;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(s))in e?Object.defineProperty(e,s,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[s]=a}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):i(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function u(e){return t=>s.createElement(d,c({attr:o({},e.attr)},t),function e(t){return t&&t.map((t,r)=>s.createElement(t.tag,o({key:r},t.attr),e(t.child)))}(e.child))}function d(e){var t=t=>{var r,{attr:a,size:n,title:i}=e,u=function(e,t){if(null==e)return{};var r,s,a=function(e,t){if(null==e)return{};var r={};for(var s in e)if(Object.prototype.hasOwnProperty.call(e,s)){if(t.indexOf(s)>=0)continue;r[s]=e[s]}return r}(e,t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);for(s=0;s<n.length;s++)r=n[s],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}(e,l),d=n||t.size||"1em";return t.className&&(r=t.className),e.className&&(r=(r?r+" ":"")+e.className),s.createElement("svg",c({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},t.attr,a,u,{className:r,style:o(o({color:e.color||t.color},t.style),e.style),height:d,width:d,xmlns:"http://www.w3.org/2000/svg"}),i&&s.createElement("title",null,i),e.children)};return void 0!==n?s.createElement(n.Consumer,null,e=>t(e)):t(a)}}},function(e){e.O(0,[7699,614,6950,707,7405,4218,8187,2952,1554,8083,6175,3464,3145,9136,8157,2971,2117,1744],function(){return e(e.s=29068)}),_N_E=e.O()}]);